<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>calendar</title>
    <link rel="stylesheet" href="calendar.css">
    <link rel="icon" href="img/logo.png" type="image/x-icon" />
    <script src="https://kit.fontawesome.com/a076d05399.js"></script>
    <script type="text/javascript" src="/eel.js"></script>
</head>

<body onload="calc()">

    <div class="calendar">
       
            <div class="calendar-grid">
                <div class="day-card">
                    <div class="card-top-area">
                        <div class="circle">
                            <h3>M</h3>
                        </div>
                    </div>
                    <div class="card-container">
                        <div class="info morning">
                            <div class="info-box" id="Monday-m-1"></div>
                            <div class="info-box" id="Monday-m-2"></div>
                            <div class="info-box" id="Monday-m-3"></div>  
                        </div>
                        <div class="divider"></div>
                        <div class="info afternoon">
                            <div class="info-box" id="Monday-a-1"></div>
                            <div class="info-box" id="Monday-a-2"></div>
                            <div class="info-box" id="Monday-a-3"></div>  
                        </div>
                    </div>
                </div>
                <div class="day-card">
                    <div class="card-top-area">
                        <div class="circle">
                            <h3>T</h3>
                        </div>
                    </div>
                    <div class="card-container">
                        <div class="info morning">
                            <div class="info-box" id="Tuesday-m-1"></div>
                            <div class="info-box" id="Tuesday-m-2"></div>
                            <div class="info-box" id="Tuesday-m-3"></div>  
                        </div>
                        <div class="divider"></div>
                        <div class="info afternoon">
                            <div class="info-box" id="Tuesday-a-1"></div>
                            <div class="info-box" id="Tuesday-a-2"></div>
                            <div class="info-box" id="Tuesday-a-3"></div>  
                        </div>
                    </div>
                </div>
                <div class="day-card">
                    <div class="card-top-area">
                        <div class="circle">
                            <h3>W</h3>
                        </div>
                    </div>
                    <div class="card-container">
                        <div class="info morning">
                            <div class="info-box" id="Wednesday-m-1"></div>
                            <div class="info-box" id="Wednesday-m-2"></div>
                            <div class="info-box" id="Wednesday-m-3"></div>  
                        </div>
                        <div class="divider"></div>
                        <div class="info afternoon">
                            <div class="info-box" id="Wednesday-a-1"></div>
                            <div class="info-box" id="Wednesday-a-2"></div>
                            <div class="info-box" id="Wednesday-a-3"></div>  
                        </div>
                    </div>
                </div>
                <div class="day-card">
                    <div class="card-top-area">
                        <div class="circle">
                            <h3>T</h3>
                        </div>
                    </div>
                    <div class="card-container">
                        <div class="info morning">
                            <div class="info-box" id="Thursday-m-1"></div>
                            <div class="info-box" id="Thursday-m-2"></div>
                            <div class="info-box" id="Thursday-m-3"></div>  
                        </div>
                        <div class="divider"></div>
                        <div class="info afternoon">
                            <div class="info-box" id="Thursday-a-1"></div>
                            <div class="info-box" id="Thursday-a-2"></div>
                            <div class="info-box" id="Thursday-a-3"></div>  
                        </div>
                    </div>
                </div>
                <div class="day-card">
                    <div class="card-top-area">
                        <div class="circle">
                            <h3>F</h3>
                        </div>
                    </div>
                    <div class="card-container">
                        <div class="info morning">
                            <div class="info-box" id="Friday-m-1"></div>
                            <div class="info-box" id="Friday-m-2"></div>
                            <div class="info-box" id="Friday-m-3"></div>  
                        </div>
                        <div class="divider"></div>
                        <div class="info afternoon">
                            <div class="info-box" id="Friday-a-1"></div>
                            <div class="info-box" id="Friday-a-2"></div>
                            <div class="info-box" id="Friday-a-3"></div> 
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>  
    
    <script>
        eel.expose(parser)
        function parser(inp) {
            a = inp.split("\n");
            prevStr = "";
            count = 1;
            a.forEach(element => {
                htElement = "";
                b = element.split(";");
                htElement += b[0] + "-" + b[1];
                count = (prevStr == htElement) ? count + 1 : 1;
                htElement += "-" + count;
                prevStr = b[0] + "-" + b[1];
                x = document.getElementById(htElement)
                if (x != null){
                    x.textContent = b[3];
                    str = b[3];
                    semester = null;
                    if(str.match("1[0-9]{2}"))
                        semester = "first";
                    else if(b[3].match("2[0-9]{2}"))
                        semester = "second";
                    else if(b[3].match("3[0-9]{2}"))
                        semester = "third";
                    else if(b[3].match("4[0-9]{2}"))
                        semester = "fourth";
                    if(semester != null)
                        x.classList.add(semester);
                }

            })

        }
        function calc() {
            const queryString = window.location.search;
            const urlParams = new URLSearchParams(queryString);
            const course = urlParams.get('course');
            const busy = urlParams.get('busy');
            const classroom = urlParams.get('classroom');
            const service = urlParams.get('service');
            eel.calculate(course, busy, classroom, service);
        }
    </script>

</body>

</html>